#!/bin/bash
# tg2p - Telegram to Prompt
# Shell wrapper for messages-tg2prompt-telegram-retriever-handler-tdl-manager.py

# Path to the Python script
HANDLER_SCRIPT="/Users/user/____Sandruk/___PARA/__Areas/_5_CAREER/DEVOPS/automations/telegram/messages-tg2prompt-telegram-retriever-handler-tdl-manager.py"

# Usage: tg2p <identifier> <time>
# Example: tg2p shimanskij 7d
# Example: tg2p shimanskij all
#
# Special commands:
# tg2p --today-yesterday-only     # Generate Today/Yesterday files without retrieving messages
# tg2p --init-chat-orders         # Initialize or update the chat orders file

# Check if the script exists
if [ ! -f "$HANDLER_SCRIPT" ]; then
    echo "Error: tg2p handler script not found at $HANDLER_SCRIPT"
    exit 1
fi

# Handle special commands
if [ "$1" == "--today-yesterday-only" ] || [ "$1" == "--init-chat-orders" ]; then
    python3 "$HANDLER_SCRIPT" "$@" --debug
    exit $?
fi

# Set default time_spec to 1d if not provided
if [ "$#" -eq 1 ]; then
    echo "No time specified, using default: 1d"
    python3 "$HANDLER_SCRIPT" "$1" "1d" --debug
else
    # Forward all arguments to the Python handler script
    python3 "$HANDLER_SCRIPT" "$@" --debug
fi 