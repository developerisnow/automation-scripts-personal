# Folder Synchronization Specification
## Prompts
### Prompt 1
````prompt
Okay, we just successfully built script for compare.
Let's now realize @sync_folders.py but before write spec for @spec__sync_folders.md 

Objectives of script in the top of script also gets Main and duplication folders, and feed csv file path to understand which files to sync
Important do not lost data from main
1) update/add only folders from @compare_folders-2025-02-25-1202.csv 
2) before do that create backup_<folder>.orig.tar.zst with -15 encryption but not all folders only from @compare_folders-2025-02-25-1202.csv 
3) remove duplication folders rm -rf, but first archive them. but let's add optionally archive=true/false and in our run false because I have backup already
4) print all results of script in a log-sync-folders-yyyy-mm-dd-hhmm.log to see what was done log every main actions not a many mb log!

if all clear do @spec__sync_folders.md and then @spec__sync_folders.md and run it.

FIY important it's universal script to compare list of main and duplication folder and I run it with different folders and csv later
````

## Purpose
Create a script that synchronizes folders based on comparison results, ensuring data from duplicate folders is properly merged into the main folder while preserving all important data.

## Requirements

1. Use the comparison CSV file (generated by compare_folders.py) to identify folders to sync
2. Create compressed backups of affected folders before making any changes
3. Synchronize folders by:
   - Copying unique folders from duplicates to main
   - Updating folders in main with newer or larger versions from duplicates
4. Optionally remove duplicate folders after successful synchronization
5. Log all operations for review and troubleshooting

## Input Configuration
The script should allow configuration of:
- Main folder path (source)
- List of duplicate folder paths
- Path to the comparison CSV file
- Output directory for logs
- Backup options (compression level, whether to create backups)
- Cleanup options (whether to remove duplicate folders after sync)

## Process Flow
1. Read configuration from script parameters
2. Parse the comparison CSV file to identify folders to sync
3. For each folder to sync:
   - Create a backup of the destination folder in main (if it exists)
   - Copy/update the folder from the duplicate to main
4. Optionally create backups of duplicate folders before removal
5. Optionally remove duplicate folders after successful sync
6. Generate a detailed log of all operations

## Output
1. Synchronized folders in the main directory
2. Backup archives of affected folders (with timestamp and compression)
3. A log file with detailed information about the sync process:
   - Which folders were backed up
   - Which folders were synchronized
   - Which duplicate folders were removed (if applicable)
   - Any errors or warnings encountered

## Safety Measures
1. Always create backups before modifying any folders
2. Verify successful backup creation before proceeding with sync
3. Verify successful sync before removing any duplicate folders
4. Provide clear logs of all operations for audit purposes
